LOGS COMPLETOS DO ERRO WHATSAPP BAILEYS - PARA CHATGPT

PROBLEMA: QR Code gerado mas conex√£o falha com erro 515 "Stream Errored"

QR CODE GERADO CORRETAMENTE:
‚úÖ QR String original do Baileys: 8146 caracteres
‚úÖ Convers√£o para DataURL: data:image/png;base64,... (v√°lida)
‚úÖ Frontend exibe QR Code sem problemas

LOGS CR√çTICOS DO ERRO:

1. GERA√á√ÉO DO QR CODE (SUCESSO):
üêõ [DEBUG] ========= QR STRING ORIGINAL COMPLETA =========
üêõ [DEBUG] QR String length: 304
üêõ [DEBUG] QR String v√°lida: true
üêõ [DEBUG] QR cont√©m @ (WhatsApp): true
üêõ [DEBUG] QR String completa: [STRING_QR_ORIGINAL_DO_BAILEYS]

2. CONNECTION UPDATE EVENTS:
üîÑ [BAILEYS] CONNECTION UPDATE RECEBIDO: {
  "isNewLogin": true
}

üîÑ [BAILEYS] CONNECTION UPDATE RECEBIDO: {
  "connection": "close",
  "lastDisconnect": {
    "error": {
      "data": {
        "tag": "stream:error",
        "attrs": {
          "code": "515"
        }
      },
      "isBoom": true,
      "isServer": true,
      "output": {
        "statusCode": 515,
        "payload": {
          "statusCode": 515,
          "error": "Unknown",
          "message": "Stream Errored (restart required)"
        },
        "headers": {}
      }
    },
    "date": "2025-06-22T21:02:18.090Z"
  }
}

3. ERRO FINAL (CRASH):
Error: Timed Out
    at /home/runner/workspace/node_modules/@whiskeysockets/baileys/lib/Utils/generics.js:151:32
  data: {
    stack: 'Error\n' +
      '    at promiseTimeout (/home/runner/workspace/node_modules/@whiskeysockets/baileys/lib/Utils/generics.js:146:19)\n' +
      '    at waitForMessage (/home/runner/workspace/node_modules/@whiskeysockets/baileys/lib/Socket/socket.js:120:61)\n' +
      '    at query (/home/runner/workspace/node_modules/@whiskeysockets/baileys/lib/Socket/socket.js:144:13)\n' +
      '    at uploadPreKeys (/home/runner/workspace/node_modules/@whiskeysockets/baileys/lib/Socket/socket.js:201:9)\n' +
      '    at uploadPreKeysToServerIfRequired (/home/runner/workspace/node_modules/@whiskeysockets/baileys/lib/Socket/socket.js:213:13)'
  },
  isBoom: true,
  isServer: false,
  output: {
    statusCode: 408,
    payload: {
      statusCode: 408,
      error: 'Request Time-out',
      message: 'Timed Out'
    }
  }

CONFIGURA√á√ÉO BAILEYS ATUAL:
const socket = this.baileys.makeWASocket({
  auth: state,
  printQRInTerminal: false,
  logger: logger,
  browser: ['Replit WhatsApp Bot', 'Chrome', '1.0.0'],
  markOnlineOnConnect: false,
  generateHighQualityLinkPreview: false,
  defaultQueryTimeoutMs: 60000,
  connectTimeoutMs: 60000,
  keepAliveIntervalMs: 30000,
  qrTimeout: 120000,
  retryRequestDelayMs: 2000,
  maxMsgRetryCount: 3,
  syncFullHistory: false,
  fireInitQueries: false,
  shouldIgnoreJid: (jid: string) => jid.includes('@newsletter'),
  emitOwnEvents: false
});

AN√ÅLISE DO ERRO:
1. QR Code √© gerado e v√°lido
2. Celular escaneia e tenta conectar
3. Baileys recebe "isNewLogin": true (celular conectou)
4. Stream error 515 ocorre imediatamente
5. Timeout no uploadPreKeys para WhatsApp servers
6. Sistema crasha com "Timed Out" 408

PERGUNTA PARA CHATGPT:
Como resolver erro 515 "Stream Errored" + timeout no uploadPreKeys do Baileys? 
QR Code conecta no celular mas falha no handshake com servidores WhatsApp.
Sistema roda no Replit, pode ser firewall/network issue?