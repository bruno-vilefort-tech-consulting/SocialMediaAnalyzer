DEBUG COMPLETO - ERRO 515 WHATSAPP BAILEYS NO REPLIT
=====================================================

PROBLEMA IDENTIFICADO:
- QR Code √© gerado corretamente (6842 caracteres)
- Usu√°rio consegue escanear no celular
- Credenciais s√£o salvas (account, me, signalIdentities, platform)
- isNewLogin: true confirmado
- MAS conex√£o falha com erro 515 "Stream Errored (restart required)"

SEQU√äNCIA COMPLETA DOS LOGS:
1. Status inicial: isConnected=false, hasQrCode=true, qrCodeLength=6842
2. Credenciais atualizadas: ['account', 'me', 'signalIdentities', 'platform']
3. isNewLogin: true (QR Code escaneado com sucesso)
4. Credenciais salvas imediatamente
5. ERRO: connection: 'close', c√≥digo: 515, "Stream Errored (restart required)"

LOGS DETALHADOS:
```
üìä Status DB para cliente 1749849987543: {
  hasConfig: true,
  isConnected: false,
  hasQrCode: true,
  qrCodeLength: 6842,
  phoneNumber: null
}

üîê [BAILEYS] CREDENCIAIS ATUALIZADAS para cliente 1749849987543!
üîê [BAILEYS] Tipo de credenciais: [ 'account', 'me', 'signalIdentities', 'platform' ]
üîê [BAILEYS] Promise resolvida: true

üêõ [BAILEYS] EVENT LISTENER ADICIONAL: {
  "isNewLogin": true
}

‚úÖ [BAILEYS] Credenciais salvas imediatamente

üîÑ [DEBUG] CONNECTION UPDATE: {
  connection: 'close',
  hasQR: false,
  hasDisconnect: true,
  resolved: true,
  timestamp: '2025-06-23T04:29:03.849Z'
}

‚ùå [DEBUG] Conex√£o fechada - c√≥digo: 515
‚ùå [DEBUG] Erro: Stream Errored (restart required)

üêõ [BAILEYS] EVENT LISTENER ADICIONAL: {
  "connection": "close",
  "lastDisconnect": {
    "error": {
      "data": {
        "tag": "stream:error",
        "attrs": {
          "code": "515"
        }
      },
      "isBoom": true,
      "isServer": true,
      "output": {
        "statusCode": 515,
        "payload": {
          "statusCode": 515,
          "error": "Unknown",
          "message": "Stream Errored (restart required)"
        },
        "headers": {}
      }
    },
    "date": "2025-06-23T04:29:03.849Z"
  }
}
```

CONFIGURA√á√ïES APLICADAS ANTERIORMENTE:
- Version: fetchLatestBaileysVersion() com fallback [2, 2419, 6]
- Browser: ['Samsung', 'SM-G991B', '13'] (Android)
- mobile: true (usa mmg.whatsapp.net porta 443)
- fireInitQueries: true
- Timeouts: keepAlive 10s, networkIdle 45s, connect/query 60s
- Heartbeat: Ping customizado a cada 10s
- Reconex√£o apenas para c√≥digos transit√≥rios (515, 428, 408)

AMBIENTE:
- Plataforma: Replit NixOS
- Baileys: @whiskeysockets/baileys
- Problema: Erro 515 ap√≥s isNewLogin bem-sucedido

PERGUNTA PARA CHATGPT:
Como resolver o erro 515 "Stream Errored (restart required)" que ocorre logo ap√≥s isNewLogin=true no Baileys? 
O QR Code funciona, credenciais s√£o salvas, mas a conex√£o falha imediatamente com c√≥digo 515.
Ambiente: Replit com limita√ß√µes de rede corporativa.