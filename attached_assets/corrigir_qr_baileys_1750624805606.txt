Passo a passo para corrigir QR Code gerado pelo Baileys não escaneável para WhatsApp Web:

1. Remova opções não suportadas:
   • No `toDataURL`, mantenha apenas:
     {
       errorCorrectionLevel: 'M',
       width: 400,
       margin: 1,
       color: {
         dark: '#000000',
         light: '#FFFFFF'
       }
     }
   • Exclua `type`, `quality` e valores com transparência.

2. Importe corretamente o módulo QRCode:
   ```js
   import QRCode from 'qrcode';
   // ou, se usar import dinâmico:
   const { toDataURL } = await import('qrcode');
   ```

3. Use a string QR sem alterações:
   ```js
   const qrRaw = qr; // valor recebido do evento Baileys
   const qrCodeDataUrl = await QRCode.toDataURL(qrRaw, {
     errorCorrectionLevel: 'M',
     width: 400,
     margin: 1,
     color: {
       dark: '#000000',
       light: '#FFFFFF'
     }
   });
   ```

4. Verifique localmente no browser:
   • Copie o valor de `qrCodeDataUrl` do log.
   • Cole na barra de endereços para conferir a imagem.

5. Garanta envio completo ao frontend:
   • No Express, retorne JSON com:
     ```js
     res.json({ success: true, qrCode: qrCodeDataUrl });
     ```
   • No cliente, use:
     ```html
     <img src="${qrCode}" alt="QR Code" />
     ```

6. Force reload do frontend:
   • Limpe cache (Ctrl+F5) para não manter imagem antiga.

7. Teste novamente no WhatsApp Web:
   • Abra o leitor de QR no WhatsApp Desktop/Browser.
   • Aponte para o QR renderizado.

8. Reinicie o backend:
   • `npm restart` ou `pm2 restart all`.

9. Caso persista:
   • Confirme que o `qr` original (`qr.length > 200`) não foi truncado.
   • Valide conexão de rede e CORS.
